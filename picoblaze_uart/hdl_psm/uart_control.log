KCPSM6 Assembler log file for program 'D:\GitHub\ECE540EmbeddedSystem\picoblaze_uart\hdl_psm\uart_control.psm'.
Generated by KCPSM6 version v2.00
Ken Chapman - Xilinx Ltd - 30th April 2012

Assembly datestamp: 18 Oct 2012
Assembly timestamp: 21:16:27

Contents
  Assembly listing
  List of PSM files
  List of CONSTANTs
  List of TABLEs
  List of STRINGs
  List of line labels


Last occupied address: 1BE hex
Nominal program memory size: 1K    address(9:0)


Assembly listing

 Addr Code                      Instruction

 000                            ;------------------------------------------------------------------------------------------
 000                            ; KCPSM6 reference design using 'uart_tx6' and 'uart_rx6' macros.
 000                            ;
 000                            ; Ken Chapman - Xilinx Ltd
 000                            ; Modified by Dung Le
 000                            ;
 000                            ; 10th Oct 2012 - modified to simple read/echo via uart, move "send" routines to interface
 000                            ;                 file. - Le
 000                            ; 11th May 2011 - Initial version
 000                            ; 6th October 2011 - Corrections to comments only
 000                            ; 23rd April 2012 - UART interface routines placed into 'uart_interface_routines.psm'
 000                            ;                   to facilitate reuse and provide an INCLUDE directive example.
 000                            ;
 000                            ;
 000                            ; INTRODUCTION
 000                            ;
 000                            ; This program interacts with the 'uart_tx6' and 'uart_rx6' macros providing some simple
 000                            ; and fundamental examples of UART based communication. As such, this example is intended
 000                            ; to display messages on a PC based terminal (e.g. HyperTerminal) and receive inputs typed
 000                            ; on a keyboard by the user.
 000                            ;
 000                            ; The user is prompted to enter a 4-digit hexadecimal value which KCPSM6 converts to
 000                            ; decimal and displays if it is valid. It is hoped that this will also provide you with
 000                            ; several routines that you will find useful in your own programs.
 000                            ;
 000                            ; Please see 'UART6_User_Guide_30April12.pdf' for more detailed descriptions of the
 000                            ; hardware circuit. The 'UART_TX' and 'UART_RX' routines that form the software interface
 000                            ; with the macros are contained in 'uart_interface_routines.psm' together with a set of
 000                            ; constants which define the allocation of I/O ports and the signals within them. The
 000                            ; 'uart_interface_routines.psm' also presents an example of using the INCLUDE directive
 000                            ; introduced with KCPSM6 Assembler v2.00.
 000                            ;
 000                            ;
 000                            ;------------------------------------------------------------------------------------------
 000                            ; Port definitions
 000                            ;------------------------------------------------------------------------------------------
 000                            ;
 000                            ; The only I/O ports used in this design are those that interface with the UART macros.
 000                            ; CONSTANT directives defining the port addresses and the allocation of signals within
 000                            ; those ports are defined in 'uart_interface_routines.psm'.
 000                            ;
 000                            ;
 000                            ;------------------------------------------------------------------------------------------
 000                            ; Special Register usage
 000                            ;------------------------------------------------------------------------------------------
 000                            ;
 000                            ; No registers are given special names in this program.
 000                            ;
 000                            ;------------------------------------------------------------------------------------------
 000                            ; Initialise the system
 000                            ;------------------------------------------------------------------------------------------
 000                            ;
 000                            ; A delay of 1 second is implemented which is intended to give time for all the hardware
 000                            ; to settle into a stable condition before starting to doing anything. This can be
 000                            ; particularly beneficial when dealing with long cables where serial lines can take some
 000                            ; time to reach the initial idle state following power being applied.
 000                            ;
 000  201B6         cold_start: CALL 1B6[delay_1s]                           ;
 001                            ;
 001  20180                     CALL 180[reset_UART_macros]                  ;Reset buffers in UART macros
 002                            ;
 002                            ;
 002                            ; Initialised terminal display and display welcome messages
 002                            ;
 002  2019C                     CALL 19C[clear_screen]
 003  20008                     CALL 008[welcome_message]
 004                            ;
 004                            ;
 004                            ;------------------------------------------------------------------------------------------
 004                            ; Main Program
 004                            ;------------------------------------------------------------------------------------------
 004                            ;
 004                            ;
 004                      main: ;LOAD sA, 00                     ; initialise potentially unused bits to zero
 004  20188                     CALL 188[UART_RX]                            ; wait for a character and return in s5
 005  32004                     JUMP Z, 004[main]                            ; continue to wait if timeout occurs
 006  20183                     CALL 183[UART_TX]                            ; echo back msg
 007                            ;CALL send_CR
 007                            ;CALL send_CR
 007                            ; LOAD sB, prompt_msg'upper       ;prompt user to enter a HEX value
 007                            ; LOAD sA, prompt_msg'lower
 007                            ; CALL send_message
 007                            ; CALL send_CR
 007                            ;CALL send_CR
 007                            ; LOAD s5, ">"
 007                            ; CALL UART_TX
 007                            ; CALL send_space                 ;advance cursor to prompt for address
 007                            ; LOAD sE, 4'd                    ;obtain 4-digit value
 007                            ; CALL obtain_value               ;16-bit value returned in [sB,sA]
 007                            ; JUMP C, bad_hex_input           ;Carry set for a bad hex value
 007                            ; STORE sA, hex_value0            ;store value in scratch pad
 007                            ; STORE sB, hex_value1
 007                            ; CALL send_CR
 007                            ; LOAD sB, result_msg'upper       ;display the HEX and its decimal equivalent
 007                            ; LOAD sA, result_msg'lower
 007                            ; CALL send_message
 007                            ; FETCH sA, hex_value0            ;retrieve 16-bit value into [sB,sA]
 007                            ; FETCH sB, hex_value1
 007                            ; CALL send_hex_word              ;send value of [sB,sA] to UART Tx
 007                            ; CALL send_space
 007                            ; LOAD s5, "i"
 007                            ; CALL UART_TX
 007                            ; LOAD s5, "s"
 007                            ; CALL UART_TX
 007                            ; CALL send_space
 007                            ; FETCH s2, hex_value0            ;retrieve 16-bit value into [s3,s2]
 007                            ; FETCH s3, hex_value1
 007                            ; CALL send_integer               ;convert [s3,s2] to decimal and transmit
 007  22004                     JUMP 004[main]
 008                            ;
 008                            ;------------------------------------------------------------------------------------------
 008                            ; Welcome Message.
 008                            ;------------------------------------------------------------------------------------------
 008                            ;
 008                            ; The welcome message includes a display of the version information available from the
 008                            ; assembler and the 'hwbuild' from the instantiation of KCPSM6 in the hardware design.
 008                            ;
 008  01B00    welcome_message: LOAD sB, 00[welcome_msg'upper]
 009  01A0F                     LOAD sA, 0F[welcome_msg'lower]
 00A  20191                     CALL 191[send_message]
 00B  14580                     HWBUILD s5                                   ;hardware version defines ASCII letter
 00C  20183                     CALL 183[UART_TX]
 00D  20198                     CALL 198[send_CR]
 00E  25000                     RETURN 
 00F                            ;
 00F                            ; Welcome message
 00F                            ;
 00F                            STRING banner1$, "  _  ______ ____  ____  __  __  __"
 00F                            STRING banner2$, " | |/ / ___|  _ \/ ___||  \/  |/ /_"
 00F                            STRING banner3$, " | ' / |   | |_) \___ \| |\/| | '_ \"
 00F                            STRING banner4$, " | . \ |___|  __/ ___) | |  | | (_) )"
 00F                            STRING banner5$, " |_|\_\____|_|   |____/|_|  |_|\___/"
 00F                            ;
 00F                            ; Welcome message
 00F                            ;
 00F                            STRING welcome1$, "Example using the 'uart_tx6' and 'uart_rx6': type -> echo to screen"
 00F                            STRING welcome2$, "Assembly Date: "
 00F                            STRING welcome3$, "   Time: "
 00F                            STRING welcome4$, "Assembler Version: "
 00F                            STRING welcome5$, "Hardware Design: Testing 7... -le"
 00F                            STRING welcome6$, "type here: "
 00F                            ;
 00F                            ;
 00F  21520        welcome_msg: LOAD&RETURN s5, 20[banner1$:" "]
 010  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 011  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 012  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 013  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 014  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 015  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 016  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 017  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 018  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 019  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01A  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 01B  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01C  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01D  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01E  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01F  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 020  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 021  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 022  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 023  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 024  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 025  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 026  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 027  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 028  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 029  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 02A  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 02B  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 02C  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 02D  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 02E  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 02F  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 030  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 031  2150D                     LOAD&RETURN s5, 0D[character_CR]
 032  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 033  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 034  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 035  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 036  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 037  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 038  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 039  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 03A  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 03B  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 03C  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 03D  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 03E  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 03F  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 040  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 041  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 042  2155C                     LOAD&RETURN s5, 5C[banner2$:"\"]
 043  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 044  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 045  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 046  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 047  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 048  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 049  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 04A  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 04B  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 04C  2155C                     LOAD&RETURN s5, 5C[banner2$:"\"]
 04D  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 04E  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 04F  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 050  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 051  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 052  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 053  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 054  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 055  2150D                     LOAD&RETURN s5, 0D[character_CR]
 056  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 057  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 058  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 059  21527                     LOAD&RETURN s5, 27[banner3$:"'"]
 05A  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 05B  2152F                     LOAD&RETURN s5, 2F[banner3$:"/"]
 05C  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 05D  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 05E  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 05F  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 060  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 061  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 062  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 063  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 064  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 065  21529                     LOAD&RETURN s5, 29[banner3$:")"]
 066  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 067  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 068  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 069  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 06A  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 06B  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 06C  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 06D  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 06E  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 06F  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 070  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 071  2152F                     LOAD&RETURN s5, 2F[banner3$:"/"]
 072  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 073  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 074  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 075  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 076  21527                     LOAD&RETURN s5, 27[banner3$:"'"]
 077  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 078  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 079  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 07A  2150D                     LOAD&RETURN s5, 0D[character_CR]
 07B  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 07C  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 07D  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 07E  2152E                     LOAD&RETURN s5, 2E[banner4$:"."]
 07F  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 080  2155C                     LOAD&RETURN s5, 5C[banner4$:"\"]
 081  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 082  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 083  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 084  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 085  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 086  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 087  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 088  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 089  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 08A  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 08B  2152F                     LOAD&RETURN s5, 2F[banner4$:"/"]
 08C  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 08D  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 08E  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 08F  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 090  21529                     LOAD&RETURN s5, 29[banner4$:")"]
 091  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 092  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 093  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 094  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 095  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 096  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 097  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 098  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 099  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 09A  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 09B  21528                     LOAD&RETURN s5, 28[banner4$:"("]
 09C  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 09D  21529                     LOAD&RETURN s5, 29[banner4$:")"]
 09E  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 09F  21529                     LOAD&RETURN s5, 29[banner4$:")"]
 0A0  2150D                     LOAD&RETURN s5, 0D[character_CR]
 0A1  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0A2  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0A3  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0A4  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0A5  2155C                     LOAD&RETURN s5, 5C[banner5$:"\"]
 0A6  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0A7  2155C                     LOAD&RETURN s5, 5C[banner5$:"\"]
 0A8  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0A9  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AA  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AB  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AC  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0AD  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AE  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0AF  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0B0  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0B1  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0B2  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0B3  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B4  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B5  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B6  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B7  2152F                     LOAD&RETURN s5, 2F[banner5$:"/"]
 0B8  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0B9  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0BA  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0BB  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0BC  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0BD  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0BE  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0BF  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0C0  2155C                     LOAD&RETURN s5, 5C[banner5$:"\"]
 0C1  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C2  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C3  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C4  2152F                     LOAD&RETURN s5, 2F[banner5$:"/"]
 0C5  2150D                     LOAD&RETURN s5, 0D[character_CR]
 0C6  2150D                     LOAD&RETURN s5, 0D[character_CR]
 0C7  21545                     LOAD&RETURN s5, 45[welcome1$:"E"]
 0C8  21578                     LOAD&RETURN s5, 78[welcome1$:"x"]
 0C9  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0CA  2156D                     LOAD&RETURN s5, 6D[welcome1$:"m"]
 0CB  21570                     LOAD&RETURN s5, 70[welcome1$:"p"]
 0CC  2156C                     LOAD&RETURN s5, 6C[welcome1$:"l"]
 0CD  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0CE  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0CF  21575                     LOAD&RETURN s5, 75[welcome1$:"u"]
 0D0  21573                     LOAD&RETURN s5, 73[welcome1$:"s"]
 0D1  21569                     LOAD&RETURN s5, 69[welcome1$:"i"]
 0D2  2156E                     LOAD&RETURN s5, 6E[welcome1$:"n"]
 0D3  21567                     LOAD&RETURN s5, 67[welcome1$:"g"]
 0D4  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0D5  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0D6  21568                     LOAD&RETURN s5, 68[welcome1$:"h"]
 0D7  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0D8  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0D9  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0DA  21575                     LOAD&RETURN s5, 75[welcome1$:"u"]
 0DB  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0DC  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 0DD  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0DE  2155F                     LOAD&RETURN s5, 5F[welcome1$:"_"]
 0DF  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0E0  21578                     LOAD&RETURN s5, 78[welcome1$:"x"]
 0E1  21536                     LOAD&RETURN s5, 36[welcome1$:"6"]
 0E2  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0E3  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0E4  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0E5  2156E                     LOAD&RETURN s5, 6E[welcome1$:"n"]
 0E6  21564                     LOAD&RETURN s5, 64[welcome1$:"d"]
 0E7  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0E8  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0E9  21575                     LOAD&RETURN s5, 75[welcome1$:"u"]
 0EA  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0EB  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 0EC  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0ED  2155F                     LOAD&RETURN s5, 5F[welcome1$:"_"]
 0EE  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 0EF  21578                     LOAD&RETURN s5, 78[welcome1$:"x"]
 0F0  21536                     LOAD&RETURN s5, 36[welcome1$:"6"]
 0F1  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0F2  2153A                     LOAD&RETURN s5, 3A[welcome1$:":"]
 0F3  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0F4  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0F5  21579                     LOAD&RETURN s5, 79[welcome1$:"y"]
 0F6  21570                     LOAD&RETURN s5, 70[welcome1$:"p"]
 0F7  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0F8  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0F9  2152D                     LOAD&RETURN s5, 2D[welcome1$:"-"]
 0FA  2153E                     LOAD&RETURN s5, 3E[welcome1$:">"]
 0FB  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0FC  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0FD  21563                     LOAD&RETURN s5, 63[welcome1$:"c"]
 0FE  21568                     LOAD&RETURN s5, 68[welcome1$:"h"]
 0FF  2156F                     LOAD&RETURN s5, 6F[welcome1$:"o"]
 100  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 101  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 102  2156F                     LOAD&RETURN s5, 6F[welcome1$:"o"]
 103  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 104  21573                     LOAD&RETURN s5, 73[welcome1$:"s"]
 105  21563                     LOAD&RETURN s5, 63[welcome1$:"c"]
 106  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 107  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 108  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 109  2156E                     LOAD&RETURN s5, 6E[welcome1$:"n"]
 10A  2150D                     LOAD&RETURN s5, 0D[character_CR]
 10B  2150D                     LOAD&RETURN s5, 0D[character_CR]
 10C  21541                     LOAD&RETURN s5, 41[welcome2$:"A"]
 10D  21573                     LOAD&RETURN s5, 73[welcome2$:"s"]
 10E  21573                     LOAD&RETURN s5, 73[welcome2$:"s"]
 10F  21565                     LOAD&RETURN s5, 65[welcome2$:"e"]
 110  2156D                     LOAD&RETURN s5, 6D[welcome2$:"m"]
 111  21562                     LOAD&RETURN s5, 62[welcome2$:"b"]
 112  2156C                     LOAD&RETURN s5, 6C[welcome2$:"l"]
 113  21579                     LOAD&RETURN s5, 79[welcome2$:"y"]
 114  21520                     LOAD&RETURN s5, 20[welcome2$:" "]
 115  21544                     LOAD&RETURN s5, 44[welcome2$:"D"]
 116  21561                     LOAD&RETURN s5, 61[welcome2$:"a"]
 117  21574                     LOAD&RETURN s5, 74[welcome2$:"t"]
 118  21565                     LOAD&RETURN s5, 65[welcome2$:"e"]
 119  2153A                     LOAD&RETURN s5, 3A[welcome2$:":"]
 11A  21520                     LOAD&RETURN s5, 20[welcome2$:" "]
 11B  21531                     LOAD&RETURN s5, 31[datestamp$:"1"]
 11C  21538                     LOAD&RETURN s5, 38[datestamp$:"8"]
 11D  21520                     LOAD&RETURN s5, 20[datestamp$:" "]
 11E  2154F                     LOAD&RETURN s5, 4F[datestamp$:"O"]
 11F  21563                     LOAD&RETURN s5, 63[datestamp$:"c"]
 120  21574                     LOAD&RETURN s5, 74[datestamp$:"t"]
 121  21520                     LOAD&RETURN s5, 20[datestamp$:" "]
 122  21532                     LOAD&RETURN s5, 32[datestamp$:"2"]
 123  21530                     LOAD&RETURN s5, 30[datestamp$:"0"]
 124  21531                     LOAD&RETURN s5, 31[datestamp$:"1"]
 125  21532                     LOAD&RETURN s5, 32[datestamp$:"2"]
 126  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 127  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 128  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 129  21554                     LOAD&RETURN s5, 54[welcome3$:"T"]
 12A  21569                     LOAD&RETURN s5, 69[welcome3$:"i"]
 12B  2156D                     LOAD&RETURN s5, 6D[welcome3$:"m"]
 12C  21565                     LOAD&RETURN s5, 65[welcome3$:"e"]
 12D  2153A                     LOAD&RETURN s5, 3A[welcome3$:":"]
 12E  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 12F  21532                     LOAD&RETURN s5, 32[timestamp$:"2"]
 130  21531                     LOAD&RETURN s5, 31[timestamp$:"1"]
 131  2153A                     LOAD&RETURN s5, 3A[timestamp$:":"]
 132  21531                     LOAD&RETURN s5, 31[timestamp$:"1"]
 133  21536                     LOAD&RETURN s5, 36[timestamp$:"6"]
 134  2153A                     LOAD&RETURN s5, 3A[timestamp$:":"]
 135  21532                     LOAD&RETURN s5, 32[timestamp$:"2"]
 136  21537                     LOAD&RETURN s5, 37[timestamp$:"7"]
 137  2150D                     LOAD&RETURN s5, 0D[character_CR]
 138  21541                     LOAD&RETURN s5, 41[welcome4$:"A"]
 139  21573                     LOAD&RETURN s5, 73[welcome4$:"s"]
 13A  21573                     LOAD&RETURN s5, 73[welcome4$:"s"]
 13B  21565                     LOAD&RETURN s5, 65[welcome4$:"e"]
 13C  2156D                     LOAD&RETURN s5, 6D[welcome4$:"m"]
 13D  21562                     LOAD&RETURN s5, 62[welcome4$:"b"]
 13E  2156C                     LOAD&RETURN s5, 6C[welcome4$:"l"]
 13F  21565                     LOAD&RETURN s5, 65[welcome4$:"e"]
 140  21572                     LOAD&RETURN s5, 72[welcome4$:"r"]
 141  21520                     LOAD&RETURN s5, 20[welcome4$:" "]
 142  21556                     LOAD&RETURN s5, 56[welcome4$:"V"]
 143  21565                     LOAD&RETURN s5, 65[welcome4$:"e"]
 144  21572                     LOAD&RETURN s5, 72[welcome4$:"r"]
 145  21573                     LOAD&RETURN s5, 73[welcome4$:"s"]
 146  21569                     LOAD&RETURN s5, 69[welcome4$:"i"]
 147  2156F                     LOAD&RETURN s5, 6F[welcome4$:"o"]
 148  2156E                     LOAD&RETURN s5, 6E[welcome4$:"n"]
 149  2153A                     LOAD&RETURN s5, 3A[welcome4$:":"]
 14A  21520                     LOAD&RETURN s5, 20[welcome4$:" "]
 14B  21576                     LOAD&RETURN s5, 76[KCPSM6_version$:"v"]
 14C  21532                     LOAD&RETURN s5, 32[KCPSM6_version$:"2"]
 14D  2152E                     LOAD&RETURN s5, 2E[KCPSM6_version$:"."]
 14E  21530                     LOAD&RETURN s5, 30[KCPSM6_version$:"0"]
 14F  21530                     LOAD&RETURN s5, 30[KCPSM6_version$:"0"]
 150  2150D                     LOAD&RETURN s5, 0D[character_CR]
 151  21548                     LOAD&RETURN s5, 48[welcome5$:"H"]
 152  21561                     LOAD&RETURN s5, 61[welcome5$:"a"]
 153  21572                     LOAD&RETURN s5, 72[welcome5$:"r"]
 154  21564                     LOAD&RETURN s5, 64[welcome5$:"d"]
 155  21577                     LOAD&RETURN s5, 77[welcome5$:"w"]
 156  21561                     LOAD&RETURN s5, 61[welcome5$:"a"]
 157  21572                     LOAD&RETURN s5, 72[welcome5$:"r"]
 158  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 159  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 15A  21544                     LOAD&RETURN s5, 44[welcome5$:"D"]
 15B  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 15C  21573                     LOAD&RETURN s5, 73[welcome5$:"s"]
 15D  21569                     LOAD&RETURN s5, 69[welcome5$:"i"]
 15E  21567                     LOAD&RETURN s5, 67[welcome5$:"g"]
 15F  2156E                     LOAD&RETURN s5, 6E[welcome5$:"n"]
 160  2153A                     LOAD&RETURN s5, 3A[welcome5$:":"]
 161  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 162  21554                     LOAD&RETURN s5, 54[welcome5$:"T"]
 163  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 164  21573                     LOAD&RETURN s5, 73[welcome5$:"s"]
 165  21574                     LOAD&RETURN s5, 74[welcome5$:"t"]
 166  21569                     LOAD&RETURN s5, 69[welcome5$:"i"]
 167  2156E                     LOAD&RETURN s5, 6E[welcome5$:"n"]
 168  21567                     LOAD&RETURN s5, 67[welcome5$:"g"]
 169  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 16A  21537                     LOAD&RETURN s5, 37[welcome5$:"7"]
 16B  2152E                     LOAD&RETURN s5, 2E[welcome5$:"."]
 16C  2152E                     LOAD&RETURN s5, 2E[welcome5$:"."]
 16D  2152E                     LOAD&RETURN s5, 2E[welcome5$:"."]
 16E  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 16F  2152D                     LOAD&RETURN s5, 2D[welcome5$:"-"]
 170  2156C                     LOAD&RETURN s5, 6C[welcome5$:"l"]
 171  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 172  2150D                     LOAD&RETURN s5, 0D[character_CR]
 173  2150D                     LOAD&RETURN s5, 0D[character_CR]
 174  21574                     LOAD&RETURN s5, 74[welcome6$:"t"]
 175  21579                     LOAD&RETURN s5, 79[welcome6$:"y"]
 176  21570                     LOAD&RETURN s5, 70[welcome6$:"p"]
 177  21565                     LOAD&RETURN s5, 65[welcome6$:"e"]
 178  21520                     LOAD&RETURN s5, 20[welcome6$:" "]
 179  21568                     LOAD&RETURN s5, 68[welcome6$:"h"]
 17A  21565                     LOAD&RETURN s5, 65[welcome6$:"e"]
 17B  21572                     LOAD&RETURN s5, 72[welcome6$:"r"]
 17C  21565                     LOAD&RETURN s5, 65[welcome6$:"e"]
 17D  2153A                     LOAD&RETURN s5, 3A[welcome6$:":"]
 17E  21520                     LOAD&RETURN s5, 20[welcome6$:" "]
 17F  21500                     LOAD&RETURN s5, 00[character_NULL]
 180                            ;
 180                            ;
 180                            ;------------------------------------------------------------------------------------------
 180                            ; Include PSM files
 180                            ;------------------------------------------------------------------------------------------
 180                            ; NOTE : THIS INCLUDE SECTION MUST BE PLACED AT THE BOTTOM
 180                            ;
 180                            ; The INCLUDE directive enables commonly routines to be kept in their own PSM files and
 180                            ; easily reused in different programs (i.e. avoiding 'cut and paste'). It also allows
 180                            ; each PSM to remain a more manageable size.
 180                            ;
 180                            ;
 180                            ; Include routines that implement interface with UART macros.
 180                            ; -----------------------------------------------------------
 180                            ;
 180                            INCLUDE "D:\GitHub\ECE540EmbeddedSystem\picoblaze_uart\hdl_psm\uart_interface_routines.psm"["uart_interface_routines.psm"]
 180                            ;
 180                            ;------------------------------------------------------------------------------------------
 180                            ; Copyright © 2011-2012, Xilinx, Inc.
 180                            ; This file contains confidential and proprietary information of Xilinx, Inc. and is
 180                            ; protected under U.S. and international copyright and other intellectual property laws.
 180                            ;------------------------------------------------------------------------------------------
 180                            ;
 180                            ; Ken Chapman - Xilinx Ltd 23rd April 2012
 180                            ;
 180                            ; Modified by Dung Le
 180                            ;
 180                            ; 10th Oct 2012 - modified to simple read/echo via uart, move "send" routines from
 180                            ; uart_control.psm over here. - Le
 180                            ;------------------------------------------------------------------------------------------
 180                            ; This file contains routines used to interface with the UART6 macros provided with KCPSM6
 180                            ; and was first supplied with a reference design called 'uart6_605' included in the
 180                            ; PicoBlaze package. The routines enable characters to be transmitted to and received
 180                            ; from the UART macros as well as perform a reset of the FIFO the buffers.
 180                            ;
 180                            ;     NOTE - This is not a standalone PSM file. The 'uart_control.psm' file supplied with
 180                            ;            the reference design stated above includes this file and calls the routines
 180                            ;            contained in this file.
 180                            ;
 180                            ;                INCLUDE "uart_interface_routines.psm"
 180                            ;
 180                            ;     Hint - The INCLUDE directive was introduced in KCPSM6 Assembler v2.00.
 180                            ;
 180                            ;
 180                            ; Whilst the reference design stated above was presented for the UART macros connected to
 180                            ; the USB/UART interface on the Xilinx ML605 Evaluation Kit this file can be ported to
 180                            ; any design for any board simply by setting the appropriate values in the CONSTANT
 180                            ; directives described below.
 180                            ;
 180                            ;
 180                            ;------------------------------------------------------------------------------------------
 180                            ; Hardware Constants
 180                            ;------------------------------------------------------------------------------------------
 180                            ;
 180                            ; The CONSTANT directives below define the input and output ports assigned to the UART
 180                            ; macros that implement a 115,200 baud rate communication with the USB/UART on the board.
 180                            ; Additional constants identify the allocation of signals to bits within a port.
 180                            ;
 180                            ;
 180                            ;
 180                            ; UART Status
 180                            ; -----------
 180                            ;
 180                            CONSTANT UART_status_port, 00                ; Read status
 180                            CONSTANT UART_Tx_data_present, 00000001'b    ; Tx   data_present - bit0
 180                            CONSTANT UART_Tx_half_full, 00000010'b       ;         half_full - bit1
 180                            CONSTANT UART_Tx_full, 00000100'b            ;              full - bit2
 180                            CONSTANT UART_Rx_data_present, 00001000'b    ; Rx   data_present - bit3
 180                            CONSTANT UART_Rx_half_full, 00010000'b       ;         half_full - bit4
 180                            CONSTANT UART_Rx_full, 00100000'b            ;              full - bit5
 180                            ;
 180                            ; Write data to UART_TX6
 180                            ; ----------------------
 180                            ;
 180                            CONSTANT UART_TX6_output_port, 01
 180                            ;
 180                            ; Read data from UART_RX6
 180                            ; -----------------------
 180                            ;
 180                            CONSTANT UART_RX6_input_port, 01
 180                            ;
 180                            ; Reset UART buffers (Constant Optimised Port)
 180                            ; --------------------------------------------
 180                            ;
 180                            CONSTANT reset_UART_port, 01
 180                            CONSTANT UART_tx_reset, 00000001'b           ; uart_tx6 reset - bit0
 180                            CONSTANT UART_rx_reset, 00000010'b           ; uart_rx6 reset - bit1
 180                            CONSTANT UART_reset, 00000011'b              ; reset Tx and Rx
 180                            CONSTANT UART_operate, 00000000'b            ; Tx and Rx free to operate
 180                            ;
 180                            ;
 180                            ;------------------------------------------------------------------------------------------
 180                            ; Scratch Pad Memory Locations
 180                            ;------------------------------------------------------------------------------------------
 180                            ;
 180                            CONSTANT hex_value0, 00                      ;16-bit value (lower byte)
 180                            CONSTANT hex_value1, 01                      ;16-bit value (upper byte)
 180                            ;
 180                            CONSTANT decimal0, 02                        ;5 digit decimal value
 180                            CONSTANT decimal1, 03                        ;  Suitable for 16-bit values up to
 180                            CONSTANT decimal2, 04                        ;   65,536
 180                            CONSTANT decimal3, 05
 180                            CONSTANT decimal4, 06
 180                            ;
 180                            ;
 180                            ;------------------------------------------------------------------------------------------
 180                            ; Useful data constants
 180                            ;------------------------------------------------------------------------------------------
 180                            ;
 180                            ;
 180                            ; ASCII codes
 180                            ;
 180                            CONSTANT character_NULL, 00                  ;NULL
 180                            CONSTANT character_BS, 08                    ;Back Space
 180                            CONSTANT character_LF, 0A                    ;line feed
 180                            CONSTANT character_CR, 0D                    ;carriage return
 180                            CONSTANT character_ESC, 1B                   ;Escape
 180                            ;
 180                            ;
 180                            ;--------------------------------------------------------------------------------------
 180                            ; Routine to reset UART Buffers inside 'UART_TX6' and 'UART_RX6'
 180                            ;--------------------------------------------------------------------------------------
 180                            ;
 180                            ; This routine will generate and apply an active High reset pulse to  the FIFO
 180                            ; buffers in both the transmitter and receiver macros.
 180                            ;
 180                            ; Note that the reset signals have been assigned to a constant optimised output port
 180                            ; so the 'OUTPUTK' instructions are used and no registers contents are affected.
 180                            ;
 180                            ;
 180  2B031  reset_UART_macros: OUTPUTK 03[UART_reset], 1[reset_UART_port]
 181  2B001                     OUTPUTK 00[UART_operate], 1[reset_UART_port]
 182  25000                     RETURN 
 183                            ;
 183                            ;
 183                            ;--------------------------------------------------------------------------------------
 183                            ; Routine to send one character to the UART Transmitter (UART_TX6)
 183                            ;--------------------------------------------------------------------------------------
 183                            ;
 183                            ; This routine will transmit the character provided in register 's5'.
 183                            ;
 183                            ; Before the character is output to the 'UART_TX6' macro the status of the FIFO buffer
 183                            ; is checked to see if there is space. If the buffer is full then this routine will
 183                            ; wait for space to become available (e.g. the time required for a previous character
 183                            ; to be transmitted by the UART).
 183                            ;
 183                            ; Registers used s0 and s5 for the data (which is preserved)
 183                            ;
 183  09000            UART_TX: INPUT s0, 00[UART_status_port]               ;Check if buffer is full
 184  0D004                     TEST s0, 04[UART_Tx_full]
 185  36183                     JUMP NZ, 183[UART_TX]                        ;wait if full
 186  2D501                     OUTPUT s5, 01[UART_TX6_output_port]
 187  25000                     RETURN 
 188                            ;
 188                            ;
 188                            ;--------------------------------------------------------------------------------------
 188                            ; Routine to attempt to receive one character from the UART Receiver (UART_RX6)
 188                            ;--------------------------------------------------------------------------------------
 188                            ;
 188                            ; This routine will attempt to receive one character from the 'UART_RX6' macro, and if
 188                            ; successful, will return that character in register 's5' and the Zero flag will be
 188                            ; reset (Z=0).
 188                            ;
 188                            ; If there are no characters available to be read from the FIFO buffer within the
 188                            ; 'UART_RX6' macro then this routine will timeout after ~2,000 clock cycles (which is
 188                            ; 40us at 50MHz) with the Zero flag set (Z=1). This timeout scheme ensures that KCPSM6
 188                            ; cannot become stuck in this routine if no characters are received. If you do want
 188                            ; KCPSM6 to wait indefinitely for a character to be received then either modify this
 188                            ; routine or perform a test of the Zero flag and repeat the call to this routine as
 188                            ; shown in this example...
 188                            ;
 188                            ;          wait_for_UART_RX: CALL UART_RX
 188                            ;                            JUMP Z, wait_for_UART_RX
 188                            ;
 188                            ;
 188                            ; Registers used s0 and s5.
 188                            ;
 188  011A7            UART_RX: LOAD s1, A7[167'd]                           ;Timeout = 167 x (6 instructions x 2 clock cycles)
 189  09000         rx_timeout: INPUT s0, 00[UART_status_port]
 18A  0D008                     TEST s0, 08[UART_Rx_data_present]            ;Z=0 and C=1 when data present
 18B  3618F                     JUMP NZ, 18F[read_Rx]
 18C  19101                     SUB s1, 01[1'd]
 18D  31000                     RETURN Z                                     ;Timeout returns with Z=1 and C=0
 18E  22189                     JUMP 189[rx_timeout]
 18F                            ;
 18F  09501            read_Rx: INPUT s5, 01[UART_RX6_input_port]            ;read character from buffer
 190  25000                     RETURN 
 191                            ;
 191                            ;
 191                            ;------------------------------------------------------------------------------------------
 191                            ; Send a message to the UART
 191                            ;------------------------------------------------------------------------------------------
 191                            ;
 191                            ; A message is transmitted to the USB-UART.
 191                            ; The start address of the message must be provided in [sB,sA].
 191                            ; Terminate the transmission with a NULL character (00 hex).
 191                            ;
 191  24BA0       send_message: CALL@ (sB, sA)
 192  1D500                     COMPARE s5, 00                               ;terminate on NUL character
 193  31000                     RETURN Z
 194  20183                     CALL 183[UART_TX]
 195  11A01                     ADD sA, 01[1'd]
 196  13B00                     ADDCY sB, 00[0'd]
 197  22191                     JUMP 191[send_message]
 198                            ;
 198                            ;
 198                            ;------------------------------------------------------------------------------------------
 198                            ; Send Carriage Return to UART
 198                            ;------------------------------------------------------------------------------------------
 198                            ;
 198                            ; Registers used s0, s1, s2, and s5.
 198                            ;
 198  0150D            send_CR: LOAD s5, 0D[character_CR]
 199  22183                     JUMP 183[UART_TX]                            ;includes RETURN
 19A                            ;
 19A                            ;
 19A                            ;------------------------------------------------------------------------------------------
 19A                            ; Send a Space to UART
 19A                            ;------------------------------------------------------------------------------------------
 19A                            ;
 19A                            ; Registers used s0, s1, s2, and s5.
 19A                            ;
 19A  01520         send_space: LOAD s5, 20[" "]
 19B  22183                     JUMP 183[UART_TX]                            ;includes RETURN
 19C                            ;
 19C                            ;
 19C                            ;------------------------------------------------------------------------------------------
 19C                            ; Clear terminal and home cursor sequences for HyperTerminal (or similar)
 19C                            ;------------------------------------------------------------------------------------------
 19C                            ;
 19C                            ; ANSI Escape Sequences/codes (VT100)
 19C                            ;
 19C  0151B       clear_screen: LOAD s5, 1B[character_ESC]                   ;clear terminal sequence
 19D  20183                     CALL 183[UART_TX]
 19E  0155B                     LOAD s5, 5B["["]
 19F  20183                     CALL 183[UART_TX]
 1A0  01532                     LOAD s5, 32["2"]
 1A1  20183                     CALL 183[UART_TX]
 1A2  0154A                     LOAD s5, 4A["J"]
 1A3  20183                     CALL 183[UART_TX]
 1A4  201AE                     CALL 1AE[delay_1ms]                          ;Delay for reliable operation
 1A5  25000                     RETURN 
 1A6                            ;
 1A6  0151B        cursor_home: LOAD s5, 1B[character_ESC]                   ;Send cursor to upper-left of display
 1A7  20183                     CALL 183[UART_TX]
 1A8  0155B                     LOAD s5, 5B["["]
 1A9  20183                     CALL 183[UART_TX]
 1AA  01548                     LOAD s5, 48["H"]
 1AB  20183                     CALL 183[UART_TX]
 1AC  201AE                     CALL 1AE[delay_1ms]                          ;Delay for reliable operation
 1AD  25000                     RETURN 
 1AE                            ;
 1AE                            ;
 1AE                            ;------------------------------------------------------------------------------------------
 1AE                            ; End of 'uart_interface_routines.psm"'
 1AE                            ;------------------------------------------------------------------------------------------
 1AE                            ;
 1AE                            INCLUDE "D:\GitHub\ECE540EmbeddedSystem\picoblaze_uart\hdl_psm\delay.psm"["delay.psm"]
 1AE                            ;------------------------------------------------------------------------------------------
 1AE                            ; Auxiliary method for delay pursoses
 1AE                            ;
 1AE                            ; Originated by Ken Chapman - Xilinx Ltd
 1AE                            ; Modified by Dung Le, 2012
 1AE                            ;------------------------------------------------------------------------------------------
 1AE                            ; Software Delays
 1AE                            ;------------------------------------------------------------------------------------------
 1AE                            ;
 1AE                            ; All based on 50MHz clock
 1AE                            ; The number of iterations of a delay loop required to form each delay required are
 1AE                            ; loaded into the register set [s2,s1,s0] and then the delay loop is started.
 1AE                            ;
 1AE                            ; Registers used s0, s1, s2
 1AE                            ;
 1AE                            ;1ms is 50,000 clock cycles requiring 6,250 delay iterations
 1AE                            ;
 1AE  01200          delay_1ms: LOAD s2, 00
 1AF  01118                     LOAD s1, 18
 1B0  0106A                     LOAD s0, 6A
 1B1  221BA                     JUMP 1BA[software_delay]
 1B2                            ;
 1B2                            ;20ms is 1,000,000 clock cycles requiring 125,000 delay iterations
 1B2                            ;
 1B2  01201         delay_20ms: LOAD s2, 01
 1B3  011E8                     LOAD s1, E8
 1B4  01048                     LOAD s0, 48
 1B5  221BA                     JUMP 1BA[software_delay]
 1B6                            ;
 1B6                            ;1s is 50,000,000 clock cycles requiring 6,250,000 delay iterations
 1B6                            ;
 1B6  0125F           delay_1s: LOAD s2, 5F
 1B7  0115E                     LOAD s1, 5E
 1B8  01010                     LOAD s0, 10
 1B9  221BA                     JUMP 1BA[software_delay]
 1BA                            ;
 1BA                            ; The delay loop decrements [s2,s1,s0] until it reaches zero
 1BA                            ; Each decrement cycle is 4 instructions which is 8 clock cycles (160ns at 50MHz)
 1BA                            ;
 1BA  19001     software_delay: SUB s0, 01[1'd]
 1BB  1B100                     SUBCY s1, 00[0'd]
 1BC  1B200                     SUBCY s2, 00[0'd]
 1BD  361BA                     JUMP NZ, 1BA[software_delay]
 1BE  25000                     RETURN 
 1BF                            ;
 1BF                            ;
 1BF                            ;
 1BF                            ;
 1BF                            ;------------------------------------------------------------------------------------------
 1BF                            ; End of Program
 1BF                            ;------------------------------------------------------------------------------------------
 1BF                            ;



List of PSM files that have been assembled

D:\GitHub\ECE540EmbeddedSystem\picoblaze_uart\hdl_psm\uart_control.psm
D:\GitHub\ECE540EmbeddedSystem\picoblaze_uart\hdl_psm\uart_interface_routines.psm
D:\GitHub\ECE540EmbeddedSystem\picoblaze_uart\hdl_psm\delay.psm



List of defined constants

 CONSTANT name        Value        Source PSM File

 timestamp_hours      21'd         
 timestamp_minutes    16'd         
 timestamp_seconds    27'd         
 datestamp_year       12'd         
 datestamp_month      10'd         
 datestamp_day        18'd         
 UART_status_port     00           uart_control.psm
 UART_Tx_data_present 00000001'b   uart_control.psm
 UART_Tx_half_full    00000010'b   uart_control.psm
 UART_Tx_full         00000100'b   uart_control.psm
 UART_Rx_data_present 00001000'b   uart_control.psm
 UART_Rx_half_full    00010000'b   uart_control.psm
 UART_Rx_full         00100000'b   uart_control.psm
 UART_TX6_output_port 01           uart_control.psm
 UART_RX6_input_port  01           uart_control.psm
 reset_UART_port      01           uart_control.psm
 UART_tx_reset        00000001'b   uart_control.psm
 UART_rx_reset        00000010'b   uart_control.psm
 UART_reset           00000011'b   uart_control.psm
 UART_operate         00000000'b   uart_control.psm
 hex_value0           00           uart_control.psm
 hex_value1           01           uart_control.psm
 decimal0             02           uart_control.psm
 decimal1             03           uart_control.psm
 decimal2             04           uart_control.psm
 decimal3             05           uart_control.psm
 decimal4             06           uart_control.psm
 character_NULL       00           uart_control.psm
 character_BS         08           uart_control.psm
 character_LF         0A           uart_control.psm
 character_CR         0D           uart_control.psm
 character_ESC        1B           uart_control.psm



No TABLEs defined



List of text strings

 STRING name       String                                                                 Source PSM File

 KCPSM6_version$   "v2.00"                                                                
 datestamp$        "18 Oct 2012"                                                          
 timestamp$        "21:16:27"                                                             
 banner1$          "  _  ______ ____  ____  __  __  __"                                   uart_control.psm
 banner2$          " | |/ / ___|  _ \/ ___||  \/  |/ /_"                                  uart_control.psm
 banner3$          " | ' / |   | |_) \___ \| |\/| | '_ \"                                 uart_control.psm
 banner4$          " | . \ |___|  __/ ___) | |  | | (_) )"                                uart_control.psm
 banner5$          " |_|\_\____|_|   |____/|_|  |_|\___/"                                 uart_control.psm
 welcome1$         "Example using the 'uart_tx6' and 'uart_rx6': type -> echo to screen"  uart_control.psm
 welcome2$         "Assembly Date: "                                                      uart_control.psm
 welcome3$         "   Time: "                                                            uart_control.psm
 welcome4$         "Assembler Version: "                                                  uart_control.psm
 welcome5$         "Hardware Design: Testing 7... -le"                                    uart_control.psm
 welcome6$         "type here: "                                                          uart_control.psm



List of line labels

 Label               Addr  Source PSM File

 cold_start          000   uart_control.psm
 main                004   uart_control.psm
 welcome_message     008   uart_control.psm
 welcome_msg         00F   uart_control.psm
 reset_UART_macros   180   uart_interface_routines.psm
 UART_TX             183   uart_interface_routines.psm
 UART_RX             188   uart_interface_routines.psm
 rx_timeout          189   uart_interface_routines.psm
 read_Rx             18F   uart_interface_routines.psm
 send_message        191   uart_interface_routines.psm
 send_CR             198   uart_interface_routines.psm
 send_space          19A   uart_interface_routines.psm
 clear_screen        19C   uart_interface_routines.psm
 cursor_home         1A6   uart_interface_routines.psm
 delay_1ms           1AE   delay.psm
 delay_20ms          1B2   delay.psm
 delay_1s            1B6   delay.psm
 software_delay      1BA   delay.psm



End of KCPSM6 log file.
