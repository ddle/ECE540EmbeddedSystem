KCPSM6 Assembler log file for program 'C:\ece540_final\picoblaze_uart\hdl_psm\uart_control.psm'.
Generated by KCPSM6 version v2.00
Ken Chapman - Xilinx Ltd - 30th April 2012

Assembly datestamp: 14 Nov 2012
Assembly timestamp: 13:31:40

Contents
  Assembly listing
  List of PSM files
  List of CONSTANTs
  List of TABLEs
  List of STRINGs
  List of line labels


Last occupied address: 1C0 hex
Nominal program memory size: 1K    address(9:0)


Assembly listing

 Addr Code                      Instruction

 000                            ;------------------------------------------------------------------------------------------
 000                            ; KCPSM6 reference design using 'uart_tx6' and 'uart_rx6' macros.
 000                            ;
 000                            ; Ken Chapman - Xilinx Ltd
 000                            ; Modified by Dung Le
 000                            ;
 000                            ; 10th Oct 2012 - modified to simple read/echo via uart, move "send" routines to interface
 000                            ;                 file. - Le
 000                            ; 11th May 2011 - Initial version
 000                            ; 6th October 2011 - Corrections to comments only
 000                            ; 23rd April 2012 - UART interface routines placed into 'uart_interface_routines.psm'
 000                            ;                   to facilitate reuse and provide an INCLUDE directive example.
 000                            ;
 000                            ;
 000                            ; INTRODUCTION
 000                            ;
 000                            ; This program interacts with the 'uart_tx6' and 'uart_rx6' macros providing some simple
 000                            ; and fundamental examples of UART based communication. As such, this example is intended
 000                            ; to display messages on a PC based terminal (e.g. HyperTerminal) and receive inputs typed
 000                            ; on a keyboard by the user.
 000                            ;
 000                            ; The user is prompted to enter a 4-digit hexadecimal value which KCPSM6 converts to
 000                            ; decimal and displays if it is valid. It is hoped that this will also provide you with
 000                            ; several routines that you will find useful in your own programs.
 000                            ;
 000                            ; Please see 'UART6_User_Guide_30April12.pdf' for more detailed descriptions of the
 000                            ; hardware circuit. The 'UART_TX' and 'UART_RX' routines that form the software interface
 000                            ; with the macros are contained in 'uart_interface_routines.psm' together with a set of
 000                            ; constants which define the allocation of I/O ports and the signals within them. The
 000                            ; 'uart_interface_routines.psm' also presents an example of using the INCLUDE directive
 000                            ; introduced with KCPSM6 Assembler v2.00.
 000                            ;
 000                            ;
 000                            ;------------------------------------------------------------------------------------------
 000                            ; Port definitions
 000                            ;------------------------------------------------------------------------------------------
 000                            ;
 000                            ; The only I/O ports used in this design are those that interface with the UART macros.
 000                            ; CONSTANT directives defining the port addresses and the allocation of signals within
 000                            ; those ports are defined in 'uart_interface_routines.psm'.
 000                            ;
 000                            ;
 000                            ;------------------------------------------------------------------------------------------
 000                            ; Special Register usage
 000                            ;------------------------------------------------------------------------------------------
 000                            ;
 000                            ; No registers are given special names in this program.
 000                            ;
 000                            ;------------------------------------------------------------------------------------------
 000                            ; Initialise the system
 000                            ;------------------------------------------------------------------------------------------
 000                            ;
 000                            ; A delay of 1 second is implemented which is intended to give time for all the hardware
 000                            ; to settle into a stable condition before starting to doing anything. This can be
 000                            ; particularly beneficial when dealing with long cables where serial lines can take some
 000                            ; time to reach the initial idle state following power being applied.
 000                            ;
 000  201B8         cold_start: CALL 1B8[delay_1s]                           ;
 001                            ;
 001  20182                     CALL 182[reset_UART_macros]                  ;Reset buffers in UART macros
 002                            ;
 002                            ;
 002                            ; Initialised terminal display and display welcome messages
 002                            ;
 002  2019E                     CALL 19E[clear_screen]
 003  2000A                     CALL 00A[welcome_message]
 004                            ;
 004                            ;
 004                            ;------------------------------------------------------------------------------------------
 004                            ; Main Program
 004                            ;------------------------------------------------------------------------------------------
 004                            ;
 004                            ;
 004                      main: ;LOAD sA, 00                     ; initialise potentially unused bits to zero
 004  2018A                     CALL 18A[UART_RX]                            ; wait for a character and return in s5
 005  32004                     JUMP Z, 004[main]                            ; continue to wait if timeout occurs
 006  20185                     CALL 185[UART_TX]                            ; echo back msg
 007  0153F                     LOAD s5, 3F["?"]
 008  20185                     CALL 185[UART_TX]                            ; echo back msg
 009                            ;CALL send_CR
 009                            ;CALL send_CR
 009                            ; LOAD sB, prompt_msg'upper       ;prompt user to enter a HEX value
 009                            ; LOAD sA, prompt_msg'lower
 009                            ; CALL send_message
 009                            ; CALL send_CR
 009                            ;CALL send_CR
 009                            ; LOAD s5, ">"
 009                            ; CALL UART_TX
 009                            ; CALL send_space                 ;advance cursor to prompt for address
 009                            ; LOAD sE, 4'd                    ;obtain 4-digit value
 009                            ; CALL obtain_value               ;16-bit value returned in [sB,sA]
 009                            ; JUMP C, bad_hex_input           ;Carry set for a bad hex value
 009                            ; STORE sA, hex_value0            ;store value in scratch pad
 009                            ; STORE sB, hex_value1
 009                            ; CALL send_CR
 009                            ; LOAD sB, result_msg'upper       ;display the HEX and its decimal equivalent
 009                            ; LOAD sA, result_msg'lower
 009                            ; CALL send_message
 009                            ; FETCH sA, hex_value0            ;retrieve 16-bit value into [sB,sA]
 009                            ; FETCH sB, hex_value1
 009                            ; CALL send_hex_word              ;send value of [sB,sA] to UART Tx
 009                            ; CALL send_space
 009                            ; LOAD s5, "i"
 009                            ; CALL UART_TX
 009                            ; LOAD s5, "s"
 009                            ; CALL UART_TX
 009                            ; CALL send_space
 009                            ; FETCH s2, hex_value0            ;retrieve 16-bit value into [s3,s2]
 009                            ; FETCH s3, hex_value1
 009                            ; CALL send_integer               ;convert [s3,s2] to decimal and transmit
 009  22004                     JUMP 004[main]
 00A                            ;
 00A                            ;------------------------------------------------------------------------------------------
 00A                            ; Welcome Message.
 00A                            ;------------------------------------------------------------------------------------------
 00A                            ;
 00A                            ; The welcome message includes a display of the version information available from the
 00A                            ; assembler and the 'hwbuild' from the instantiation of KCPSM6 in the hardware design.
 00A                            ;
 00A  01B00    welcome_message: LOAD sB, 00[welcome_msg'upper]
 00B  01A11                     LOAD sA, 11[welcome_msg'lower]
 00C  20193                     CALL 193[send_message]
 00D  14580                     HWBUILD s5                                   ;hardware version defines ASCII letter
 00E  20185                     CALL 185[UART_TX]
 00F  2019A                     CALL 19A[send_CR]
 010  25000                     RETURN 
 011                            ;
 011                            ; Welcome message
 011                            ;
 011                            STRING banner1$, "  _  ______ ____  ____  __  __  __"
 011                            STRING banner2$, " | |/ / ___|  _ \/ ___||  \/  |/ /_"
 011                            STRING banner3$, " | ' / |   | |_) \___ \| |\/| | '_ \"
 011                            STRING banner4$, " | . \ |___|  __/ ___) | |  | | (_) )"
 011                            STRING banner5$, " |_|\_\____|_|   |____/|_|  |_|\___/"
 011                            ;
 011                            ; Welcome message
 011                            ;
 011                            STRING welcome1$, "Example using the 'uart_tx6' and 'uart_rx6': type -> echo to screen"
 011                            STRING welcome2$, "Assembly Date: "
 011                            STRING welcome3$, "   Time: "
 011                            STRING welcome4$, "Assembler Version: "
 011                            STRING welcome5$, "Hardware Design: Testing 7... -le"
 011                            STRING welcome6$, "type here: "
 011                            ;
 011                            ;
 011  21520        welcome_msg: LOAD&RETURN s5, 20[banner1$:" "]
 012  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 013  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 014  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 015  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 016  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 017  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 018  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 019  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01A  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01B  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01C  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 01D  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01E  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 01F  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 020  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 021  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 022  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 023  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 024  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 025  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 026  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 027  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 028  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 029  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 02A  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 02B  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 02C  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 02D  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 02E  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 02F  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 030  21520                     LOAD&RETURN s5, 20[banner1$:" "]
 031  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 032  2155F                     LOAD&RETURN s5, 5F[banner1$:"_"]
 033  2150D                     LOAD&RETURN s5, 0D[character_CR]
 034  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 035  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 036  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 037  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 038  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 039  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 03A  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 03B  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 03C  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 03D  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 03E  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 03F  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 040  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 041  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 042  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 043  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 044  2155C                     LOAD&RETURN s5, 5C[banner2$:"\"]
 045  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 046  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 047  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 048  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 049  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 04A  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 04B  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 04C  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 04D  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 04E  2155C                     LOAD&RETURN s5, 5C[banner2$:"\"]
 04F  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 050  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 051  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 052  2157C                     LOAD&RETURN s5, 7C[banner2$:"|"]
 053  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 054  21520                     LOAD&RETURN s5, 20[banner2$:" "]
 055  2152F                     LOAD&RETURN s5, 2F[banner2$:"/"]
 056  2155F                     LOAD&RETURN s5, 5F[banner2$:"_"]
 057  2150D                     LOAD&RETURN s5, 0D[character_CR]
 058  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 059  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 05A  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 05B  21527                     LOAD&RETURN s5, 27[banner3$:"'"]
 05C  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 05D  2152F                     LOAD&RETURN s5, 2F[banner3$:"/"]
 05E  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 05F  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 060  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 061  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 062  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 063  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 064  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 065  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 066  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 067  21529                     LOAD&RETURN s5, 29[banner3$:")"]
 068  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 069  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 06A  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 06B  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 06C  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 06D  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 06E  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 06F  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 070  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 071  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 072  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 073  2152F                     LOAD&RETURN s5, 2F[banner3$:"/"]
 074  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 075  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 076  2157C                     LOAD&RETURN s5, 7C[banner3$:"|"]
 077  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 078  21527                     LOAD&RETURN s5, 27[banner3$:"'"]
 079  2155F                     LOAD&RETURN s5, 5F[banner3$:"_"]
 07A  21520                     LOAD&RETURN s5, 20[banner3$:" "]
 07B  2155C                     LOAD&RETURN s5, 5C[banner3$:"\"]
 07C  2150D                     LOAD&RETURN s5, 0D[character_CR]
 07D  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 07E  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 07F  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 080  2152E                     LOAD&RETURN s5, 2E[banner4$:"."]
 081  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 082  2155C                     LOAD&RETURN s5, 5C[banner4$:"\"]
 083  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 084  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 085  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 086  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 087  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 088  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 089  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 08A  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 08B  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 08C  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 08D  2152F                     LOAD&RETURN s5, 2F[banner4$:"/"]
 08E  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 08F  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 090  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 091  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 092  21529                     LOAD&RETURN s5, 29[banner4$:")"]
 093  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 094  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 095  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 096  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 097  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 098  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 099  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 09A  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 09B  2157C                     LOAD&RETURN s5, 7C[banner4$:"|"]
 09C  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 09D  21528                     LOAD&RETURN s5, 28[banner4$:"("]
 09E  2155F                     LOAD&RETURN s5, 5F[banner4$:"_"]
 09F  21529                     LOAD&RETURN s5, 29[banner4$:")"]
 0A0  21520                     LOAD&RETURN s5, 20[banner4$:" "]
 0A1  21529                     LOAD&RETURN s5, 29[banner4$:")"]
 0A2  2150D                     LOAD&RETURN s5, 0D[character_CR]
 0A3  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0A4  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0A5  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0A6  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0A7  2155C                     LOAD&RETURN s5, 5C[banner5$:"\"]
 0A8  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0A9  2155C                     LOAD&RETURN s5, 5C[banner5$:"\"]
 0AA  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AB  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AC  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AD  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0AE  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0AF  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B0  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0B1  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0B2  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0B3  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0B4  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0B5  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B6  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B7  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B8  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0B9  2152F                     LOAD&RETURN s5, 2F[banner5$:"/"]
 0BA  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0BB  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0BC  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0BD  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0BE  21520                     LOAD&RETURN s5, 20[banner5$:" "]
 0BF  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0C0  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C1  2157C                     LOAD&RETURN s5, 7C[banner5$:"|"]
 0C2  2155C                     LOAD&RETURN s5, 5C[banner5$:"\"]
 0C3  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C4  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C5  2155F                     LOAD&RETURN s5, 5F[banner5$:"_"]
 0C6  2152F                     LOAD&RETURN s5, 2F[banner5$:"/"]
 0C7  2150D                     LOAD&RETURN s5, 0D[character_CR]
 0C8  2150D                     LOAD&RETURN s5, 0D[character_CR]
 0C9  21545                     LOAD&RETURN s5, 45[welcome1$:"E"]
 0CA  21578                     LOAD&RETURN s5, 78[welcome1$:"x"]
 0CB  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0CC  2156D                     LOAD&RETURN s5, 6D[welcome1$:"m"]
 0CD  21570                     LOAD&RETURN s5, 70[welcome1$:"p"]
 0CE  2156C                     LOAD&RETURN s5, 6C[welcome1$:"l"]
 0CF  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0D0  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0D1  21575                     LOAD&RETURN s5, 75[welcome1$:"u"]
 0D2  21573                     LOAD&RETURN s5, 73[welcome1$:"s"]
 0D3  21569                     LOAD&RETURN s5, 69[welcome1$:"i"]
 0D4  2156E                     LOAD&RETURN s5, 6E[welcome1$:"n"]
 0D5  21567                     LOAD&RETURN s5, 67[welcome1$:"g"]
 0D6  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0D7  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0D8  21568                     LOAD&RETURN s5, 68[welcome1$:"h"]
 0D9  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0DA  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0DB  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0DC  21575                     LOAD&RETURN s5, 75[welcome1$:"u"]
 0DD  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0DE  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 0DF  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0E0  2155F                     LOAD&RETURN s5, 5F[welcome1$:"_"]
 0E1  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0E2  21578                     LOAD&RETURN s5, 78[welcome1$:"x"]
 0E3  21536                     LOAD&RETURN s5, 36[welcome1$:"6"]
 0E4  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0E5  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0E6  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0E7  2156E                     LOAD&RETURN s5, 6E[welcome1$:"n"]
 0E8  21564                     LOAD&RETURN s5, 64[welcome1$:"d"]
 0E9  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0EA  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0EB  21575                     LOAD&RETURN s5, 75[welcome1$:"u"]
 0EC  21561                     LOAD&RETURN s5, 61[welcome1$:"a"]
 0ED  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 0EE  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0EF  2155F                     LOAD&RETURN s5, 5F[welcome1$:"_"]
 0F0  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 0F1  21578                     LOAD&RETURN s5, 78[welcome1$:"x"]
 0F2  21536                     LOAD&RETURN s5, 36[welcome1$:"6"]
 0F3  21527                     LOAD&RETURN s5, 27[welcome1$:"'"]
 0F4  2153A                     LOAD&RETURN s5, 3A[welcome1$:":"]
 0F5  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0F6  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 0F7  21579                     LOAD&RETURN s5, 79[welcome1$:"y"]
 0F8  21570                     LOAD&RETURN s5, 70[welcome1$:"p"]
 0F9  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0FA  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0FB  2152D                     LOAD&RETURN s5, 2D[welcome1$:"-"]
 0FC  2153E                     LOAD&RETURN s5, 3E[welcome1$:">"]
 0FD  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 0FE  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 0FF  21563                     LOAD&RETURN s5, 63[welcome1$:"c"]
 100  21568                     LOAD&RETURN s5, 68[welcome1$:"h"]
 101  2156F                     LOAD&RETURN s5, 6F[welcome1$:"o"]
 102  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 103  21574                     LOAD&RETURN s5, 74[welcome1$:"t"]
 104  2156F                     LOAD&RETURN s5, 6F[welcome1$:"o"]
 105  21520                     LOAD&RETURN s5, 20[welcome1$:" "]
 106  21573                     LOAD&RETURN s5, 73[welcome1$:"s"]
 107  21563                     LOAD&RETURN s5, 63[welcome1$:"c"]
 108  21572                     LOAD&RETURN s5, 72[welcome1$:"r"]
 109  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 10A  21565                     LOAD&RETURN s5, 65[welcome1$:"e"]
 10B  2156E                     LOAD&RETURN s5, 6E[welcome1$:"n"]
 10C  2150D                     LOAD&RETURN s5, 0D[character_CR]
 10D  2150D                     LOAD&RETURN s5, 0D[character_CR]
 10E  21541                     LOAD&RETURN s5, 41[welcome2$:"A"]
 10F  21573                     LOAD&RETURN s5, 73[welcome2$:"s"]
 110  21573                     LOAD&RETURN s5, 73[welcome2$:"s"]
 111  21565                     LOAD&RETURN s5, 65[welcome2$:"e"]
 112  2156D                     LOAD&RETURN s5, 6D[welcome2$:"m"]
 113  21562                     LOAD&RETURN s5, 62[welcome2$:"b"]
 114  2156C                     LOAD&RETURN s5, 6C[welcome2$:"l"]
 115  21579                     LOAD&RETURN s5, 79[welcome2$:"y"]
 116  21520                     LOAD&RETURN s5, 20[welcome2$:" "]
 117  21544                     LOAD&RETURN s5, 44[welcome2$:"D"]
 118  21561                     LOAD&RETURN s5, 61[welcome2$:"a"]
 119  21574                     LOAD&RETURN s5, 74[welcome2$:"t"]
 11A  21565                     LOAD&RETURN s5, 65[welcome2$:"e"]
 11B  2153A                     LOAD&RETURN s5, 3A[welcome2$:":"]
 11C  21520                     LOAD&RETURN s5, 20[welcome2$:" "]
 11D  21531                     LOAD&RETURN s5, 31[datestamp$:"1"]
 11E  21534                     LOAD&RETURN s5, 34[datestamp$:"4"]
 11F  21520                     LOAD&RETURN s5, 20[datestamp$:" "]
 120  2154E                     LOAD&RETURN s5, 4E[datestamp$:"N"]
 121  2156F                     LOAD&RETURN s5, 6F[datestamp$:"o"]
 122  21576                     LOAD&RETURN s5, 76[datestamp$:"v"]
 123  21520                     LOAD&RETURN s5, 20[datestamp$:" "]
 124  21532                     LOAD&RETURN s5, 32[datestamp$:"2"]
 125  21530                     LOAD&RETURN s5, 30[datestamp$:"0"]
 126  21531                     LOAD&RETURN s5, 31[datestamp$:"1"]
 127  21532                     LOAD&RETURN s5, 32[datestamp$:"2"]
 128  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 129  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 12A  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 12B  21554                     LOAD&RETURN s5, 54[welcome3$:"T"]
 12C  21569                     LOAD&RETURN s5, 69[welcome3$:"i"]
 12D  2156D                     LOAD&RETURN s5, 6D[welcome3$:"m"]
 12E  21565                     LOAD&RETURN s5, 65[welcome3$:"e"]
 12F  2153A                     LOAD&RETURN s5, 3A[welcome3$:":"]
 130  21520                     LOAD&RETURN s5, 20[welcome3$:" "]
 131  21531                     LOAD&RETURN s5, 31[timestamp$:"1"]
 132  21533                     LOAD&RETURN s5, 33[timestamp$:"3"]
 133  2153A                     LOAD&RETURN s5, 3A[timestamp$:":"]
 134  21533                     LOAD&RETURN s5, 33[timestamp$:"3"]
 135  21531                     LOAD&RETURN s5, 31[timestamp$:"1"]
 136  2153A                     LOAD&RETURN s5, 3A[timestamp$:":"]
 137  21534                     LOAD&RETURN s5, 34[timestamp$:"4"]
 138  21530                     LOAD&RETURN s5, 30[timestamp$:"0"]
 139  2150D                     LOAD&RETURN s5, 0D[character_CR]
 13A  21541                     LOAD&RETURN s5, 41[welcome4$:"A"]
 13B  21573                     LOAD&RETURN s5, 73[welcome4$:"s"]
 13C  21573                     LOAD&RETURN s5, 73[welcome4$:"s"]
 13D  21565                     LOAD&RETURN s5, 65[welcome4$:"e"]
 13E  2156D                     LOAD&RETURN s5, 6D[welcome4$:"m"]
 13F  21562                     LOAD&RETURN s5, 62[welcome4$:"b"]
 140  2156C                     LOAD&RETURN s5, 6C[welcome4$:"l"]
 141  21565                     LOAD&RETURN s5, 65[welcome4$:"e"]
 142  21572                     LOAD&RETURN s5, 72[welcome4$:"r"]
 143  21520                     LOAD&RETURN s5, 20[welcome4$:" "]
 144  21556                     LOAD&RETURN s5, 56[welcome4$:"V"]
 145  21565                     LOAD&RETURN s5, 65[welcome4$:"e"]
 146  21572                     LOAD&RETURN s5, 72[welcome4$:"r"]
 147  21573                     LOAD&RETURN s5, 73[welcome4$:"s"]
 148  21569                     LOAD&RETURN s5, 69[welcome4$:"i"]
 149  2156F                     LOAD&RETURN s5, 6F[welcome4$:"o"]
 14A  2156E                     LOAD&RETURN s5, 6E[welcome4$:"n"]
 14B  2153A                     LOAD&RETURN s5, 3A[welcome4$:":"]
 14C  21520                     LOAD&RETURN s5, 20[welcome4$:" "]
 14D  21576                     LOAD&RETURN s5, 76[KCPSM6_version$:"v"]
 14E  21532                     LOAD&RETURN s5, 32[KCPSM6_version$:"2"]
 14F  2152E                     LOAD&RETURN s5, 2E[KCPSM6_version$:"."]
 150  21530                     LOAD&RETURN s5, 30[KCPSM6_version$:"0"]
 151  21530                     LOAD&RETURN s5, 30[KCPSM6_version$:"0"]
 152  2150D                     LOAD&RETURN s5, 0D[character_CR]
 153  21548                     LOAD&RETURN s5, 48[welcome5$:"H"]
 154  21561                     LOAD&RETURN s5, 61[welcome5$:"a"]
 155  21572                     LOAD&RETURN s5, 72[welcome5$:"r"]
 156  21564                     LOAD&RETURN s5, 64[welcome5$:"d"]
 157  21577                     LOAD&RETURN s5, 77[welcome5$:"w"]
 158  21561                     LOAD&RETURN s5, 61[welcome5$:"a"]
 159  21572                     LOAD&RETURN s5, 72[welcome5$:"r"]
 15A  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 15B  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 15C  21544                     LOAD&RETURN s5, 44[welcome5$:"D"]
 15D  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 15E  21573                     LOAD&RETURN s5, 73[welcome5$:"s"]
 15F  21569                     LOAD&RETURN s5, 69[welcome5$:"i"]
 160  21567                     LOAD&RETURN s5, 67[welcome5$:"g"]
 161  2156E                     LOAD&RETURN s5, 6E[welcome5$:"n"]
 162  2153A                     LOAD&RETURN s5, 3A[welcome5$:":"]
 163  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 164  21554                     LOAD&RETURN s5, 54[welcome5$:"T"]
 165  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 166  21573                     LOAD&RETURN s5, 73[welcome5$:"s"]
 167  21574                     LOAD&RETURN s5, 74[welcome5$:"t"]
 168  21569                     LOAD&RETURN s5, 69[welcome5$:"i"]
 169  2156E                     LOAD&RETURN s5, 6E[welcome5$:"n"]
 16A  21567                     LOAD&RETURN s5, 67[welcome5$:"g"]
 16B  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 16C  21537                     LOAD&RETURN s5, 37[welcome5$:"7"]
 16D  2152E                     LOAD&RETURN s5, 2E[welcome5$:"."]
 16E  2152E                     LOAD&RETURN s5, 2E[welcome5$:"."]
 16F  2152E                     LOAD&RETURN s5, 2E[welcome5$:"."]
 170  21520                     LOAD&RETURN s5, 20[welcome5$:" "]
 171  2152D                     LOAD&RETURN s5, 2D[welcome5$:"-"]
 172  2156C                     LOAD&RETURN s5, 6C[welcome5$:"l"]
 173  21565                     LOAD&RETURN s5, 65[welcome5$:"e"]
 174  2150D                     LOAD&RETURN s5, 0D[character_CR]
 175  2150D                     LOAD&RETURN s5, 0D[character_CR]
 176  21574                     LOAD&RETURN s5, 74[welcome6$:"t"]
 177  21579                     LOAD&RETURN s5, 79[welcome6$:"y"]
 178  21570                     LOAD&RETURN s5, 70[welcome6$:"p"]
 179  21565                     LOAD&RETURN s5, 65[welcome6$:"e"]
 17A  21520                     LOAD&RETURN s5, 20[welcome6$:" "]
 17B  21568                     LOAD&RETURN s5, 68[welcome6$:"h"]
 17C  21565                     LOAD&RETURN s5, 65[welcome6$:"e"]
 17D  21572                     LOAD&RETURN s5, 72[welcome6$:"r"]
 17E  21565                     LOAD&RETURN s5, 65[welcome6$:"e"]
 17F  2153A                     LOAD&RETURN s5, 3A[welcome6$:":"]
 180  21520                     LOAD&RETURN s5, 20[welcome6$:" "]
 181  21500                     LOAD&RETURN s5, 00[character_NULL]
 182                            ;
 182                            ;
 182                            ;------------------------------------------------------------------------------------------
 182                            ; Include PSM files
 182                            ;------------------------------------------------------------------------------------------
 182                            ; NOTE : THIS INCLUDE SECTION MUST BE PLACED AT THE BOTTOM
 182                            ;
 182                            ; The INCLUDE directive enables commonly routines to be kept in their own PSM files and
 182                            ; easily reused in different programs (i.e. avoiding 'cut and paste'). It also allows
 182                            ; each PSM to remain a more manageable size.
 182                            ;
 182                            ;
 182                            ; Include routines that implement interface with UART macros.
 182                            ; -----------------------------------------------------------
 182                            ;
 182                            INCLUDE "C:\ece540_final\picoblaze_uart\hdl_psm\uart_interface_routines.psm"["uart_interface_routines.psm"]
 182                            ;
 182                            ;------------------------------------------------------------------------------------------
 182                            ; Copyright © 2011-2012, Xilinx, Inc.
 182                            ; This file contains confidential and proprietary information of Xilinx, Inc. and is
 182                            ; protected under U.S. and international copyright and other intellectual property laws.
 182                            ;------------------------------------------------------------------------------------------
 182                            ;
 182                            ; Ken Chapman - Xilinx Ltd 23rd April 2012
 182                            ;
 182                            ; Modified by Dung Le
 182                            ;
 182                            ; 10th Oct 2012 - modified to simple read/echo via uart, move "send" routines from
 182                            ; uart_control.psm over here. - Le
 182                            ;------------------------------------------------------------------------------------------
 182                            ; This file contains routines used to interface with the UART6 macros provided with KCPSM6
 182                            ; and was first supplied with a reference design called 'uart6_605' included in the
 182                            ; PicoBlaze package. The routines enable characters to be transmitted to and received
 182                            ; from the UART macros as well as perform a reset of the FIFO the buffers.
 182                            ;
 182                            ;     NOTE - This is not a standalone PSM file. The 'uart_control.psm' file supplied with
 182                            ;            the reference design stated above includes this file and calls the routines
 182                            ;            contained in this file.
 182                            ;
 182                            ;                INCLUDE "uart_interface_routines.psm"
 182                            ;
 182                            ;     Hint - The INCLUDE directive was introduced in KCPSM6 Assembler v2.00.
 182                            ;
 182                            ;
 182                            ; Whilst the reference design stated above was presented for the UART macros connected to
 182                            ; the USB/UART interface on the Xilinx ML605 Evaluation Kit this file can be ported to
 182                            ; any design for any board simply by setting the appropriate values in the CONSTANT
 182                            ; directives described below.
 182                            ;
 182                            ;
 182                            ;------------------------------------------------------------------------------------------
 182                            ; Hardware Constants
 182                            ;------------------------------------------------------------------------------------------
 182                            ;
 182                            ; The CONSTANT directives below define the input and output ports assigned to the UART
 182                            ; macros that implement a 115,200 baud rate communication with the USB/UART on the board.
 182                            ; Additional constants identify the allocation of signals to bits within a port.
 182                            ;
 182                            ;
 182                            ;
 182                            ; UART Status
 182                            ; -----------
 182                            ;
 182                            CONSTANT UART_status_port, 00                ; Read status
 182                            CONSTANT UART_Tx_data_present, 00000001'b    ; Tx   data_present - bit0
 182                            CONSTANT UART_Tx_half_full, 00000010'b       ;         half_full - bit1
 182                            CONSTANT UART_Tx_full, 00000100'b            ;              full - bit2
 182                            CONSTANT UART_Rx_data_present, 00001000'b    ; Rx   data_present - bit3
 182                            CONSTANT UART_Rx_half_full, 00010000'b       ;         half_full - bit4
 182                            CONSTANT UART_Rx_full, 00100000'b            ;              full - bit5
 182                            ;
 182                            ; Write data to UART_TX6
 182                            ; ----------------------
 182                            ;
 182                            CONSTANT UART_TX6_output_port, 01
 182                            ;
 182                            ; Read data from UART_RX6
 182                            ; -----------------------
 182                            ;
 182                            CONSTANT UART_RX6_input_port, 01
 182                            ;
 182                            ; Reset UART buffers (Constant Optimised Port)
 182                            ; --------------------------------------------
 182                            ;
 182                            CONSTANT reset_UART_port, 01
 182                            CONSTANT UART_tx_reset, 00000001'b           ; uart_tx6 reset - bit0
 182                            CONSTANT UART_rx_reset, 00000010'b           ; uart_rx6 reset - bit1
 182                            CONSTANT UART_reset, 00000011'b              ; reset Tx and Rx
 182                            CONSTANT UART_operate, 00000000'b            ; Tx and Rx free to operate
 182                            ;
 182                            ;
 182                            ;------------------------------------------------------------------------------------------
 182                            ; Scratch Pad Memory Locations
 182                            ;------------------------------------------------------------------------------------------
 182                            ;
 182                            CONSTANT hex_value0, 00                      ;16-bit value (lower byte)
 182                            CONSTANT hex_value1, 01                      ;16-bit value (upper byte)
 182                            ;
 182                            CONSTANT decimal0, 02                        ;5 digit decimal value
 182                            CONSTANT decimal1, 03                        ;  Suitable for 16-bit values up to
 182                            CONSTANT decimal2, 04                        ;   65,536
 182                            CONSTANT decimal3, 05
 182                            CONSTANT decimal4, 06
 182                            ;
 182                            ;
 182                            ;------------------------------------------------------------------------------------------
 182                            ; Useful data constants
 182                            ;------------------------------------------------------------------------------------------
 182                            ;
 182                            ;
 182                            ; ASCII codes
 182                            ;
 182                            CONSTANT character_NULL, 00                  ;NULL
 182                            CONSTANT character_BS, 08                    ;Back Space
 182                            CONSTANT character_LF, 0A                    ;line feed
 182                            CONSTANT character_CR, 0D                    ;carriage return
 182                            CONSTANT character_ESC, 1B                   ;Escape
 182                            ;
 182                            ;
 182                            ;--------------------------------------------------------------------------------------
 182                            ; Routine to reset UART Buffers inside 'UART_TX6' and 'UART_RX6'
 182                            ;--------------------------------------------------------------------------------------
 182                            ;
 182                            ; This routine will generate and apply an active High reset pulse to  the FIFO
 182                            ; buffers in both the transmitter and receiver macros.
 182                            ;
 182                            ; Note that the reset signals have been assigned to a constant optimised output port
 182                            ; so the 'OUTPUTK' instructions are used and no registers contents are affected.
 182                            ;
 182                            ;
 182  2B031  reset_UART_macros: OUTPUTK 03[UART_reset], 1[reset_UART_port]
 183  2B001                     OUTPUTK 00[UART_operate], 1[reset_UART_port]
 184  25000                     RETURN 
 185                            ;
 185                            ;
 185                            ;--------------------------------------------------------------------------------------
 185                            ; Routine to send one character to the UART Transmitter (UART_TX6)
 185                            ;--------------------------------------------------------------------------------------
 185                            ;
 185                            ; This routine will transmit the character provided in register 's5'.
 185                            ;
 185                            ; Before the character is output to the 'UART_TX6' macro the status of the FIFO buffer
 185                            ; is checked to see if there is space. If the buffer is full then this routine will
 185                            ; wait for space to become available (e.g. the time required for a previous character
 185                            ; to be transmitted by the UART).
 185                            ;
 185                            ; Registers used s0 and s5 for the data (which is preserved)
 185                            ;
 185  09000            UART_TX: INPUT s0, 00[UART_status_port]               ;Check if buffer is full
 186  0D004                     TEST s0, 04[UART_Tx_full]
 187  36185                     JUMP NZ, 185[UART_TX]                        ;wait if full
 188  2D501                     OUTPUT s5, 01[UART_TX6_output_port]
 189  25000                     RETURN 
 18A                            ;
 18A                            ;
 18A                            ;--------------------------------------------------------------------------------------
 18A                            ; Routine to attempt to receive one character from the UART Receiver (UART_RX6)
 18A                            ;--------------------------------------------------------------------------------------
 18A                            ;
 18A                            ; This routine will attempt to receive one character from the 'UART_RX6' macro, and if
 18A                            ; successful, will return that character in register 's5' and the Zero flag will be
 18A                            ; reset (Z=0).
 18A                            ;
 18A                            ; If there are no characters available to be read from the FIFO buffer within the
 18A                            ; 'UART_RX6' macro then this routine will timeout after ~2,000 clock cycles (which is
 18A                            ; 40us at 50MHz) with the Zero flag set (Z=1). This timeout scheme ensures that KCPSM6
 18A                            ; cannot become stuck in this routine if no characters are received. If you do want
 18A                            ; KCPSM6 to wait indefinitely for a character to be received then either modify this
 18A                            ; routine or perform a test of the Zero flag and repeat the call to this routine as
 18A                            ; shown in this example...
 18A                            ;
 18A                            ;          wait_for_UART_RX: CALL UART_RX
 18A                            ;                            JUMP Z, wait_for_UART_RX
 18A                            ;
 18A                            ;
 18A                            ; Registers used s0 and s5.
 18A                            ;
 18A  011A7            UART_RX: LOAD s1, A7[167'd]                           ;Timeout = 167 x (6 instructions x 2 clock cycles)
 18B  09000         rx_timeout: INPUT s0, 00[UART_status_port]
 18C  0D008                     TEST s0, 08[UART_Rx_data_present]            ;Z=0 and C=1 when data present
 18D  36191                     JUMP NZ, 191[read_Rx]
 18E  19101                     SUB s1, 01[1'd]
 18F  31000                     RETURN Z                                     ;Timeout returns with Z=1 and C=0
 190  2218B                     JUMP 18B[rx_timeout]
 191                            ;
 191  09501            read_Rx: INPUT s5, 01[UART_RX6_input_port]            ;read character from buffer
 192  25000                     RETURN 
 193                            ;
 193                            ;
 193                            ;------------------------------------------------------------------------------------------
 193                            ; Send a message to the UART
 193                            ;------------------------------------------------------------------------------------------
 193                            ;
 193                            ; A message is transmitted to the USB-UART.
 193                            ; The start address of the message must be provided in [sB,sA].
 193                            ; Terminate the transmission with a NULL character (00 hex).
 193                            ;
 193  24BA0       send_message: CALL@ (sB, sA)
 194  1D500                     COMPARE s5, 00                               ;terminate on NUL character
 195  31000                     RETURN Z
 196  20185                     CALL 185[UART_TX]
 197  11A01                     ADD sA, 01[1'd]
 198  13B00                     ADDCY sB, 00[0'd]
 199  22193                     JUMP 193[send_message]
 19A                            ;
 19A                            ;
 19A                            ;------------------------------------------------------------------------------------------
 19A                            ; Send Carriage Return to UART
 19A                            ;------------------------------------------------------------------------------------------
 19A                            ;
 19A                            ; Registers used s0, s1, s2, and s5.
 19A                            ;
 19A  0150D            send_CR: LOAD s5, 0D[character_CR]
 19B  22185                     JUMP 185[UART_TX]                            ;includes RETURN
 19C                            ;
 19C                            ;
 19C                            ;------------------------------------------------------------------------------------------
 19C                            ; Send a Space to UART
 19C                            ;------------------------------------------------------------------------------------------
 19C                            ;
 19C                            ; Registers used s0, s1, s2, and s5.
 19C                            ;
 19C  01520         send_space: LOAD s5, 20[" "]
 19D  22185                     JUMP 185[UART_TX]                            ;includes RETURN
 19E                            ;
 19E                            ;
 19E                            ;------------------------------------------------------------------------------------------
 19E                            ; Clear terminal and home cursor sequences for HyperTerminal (or similar)
 19E                            ;------------------------------------------------------------------------------------------
 19E                            ;
 19E                            ; ANSI Escape Sequences/codes (VT100)
 19E                            ;
 19E  0151B       clear_screen: LOAD s5, 1B[character_ESC]                   ;clear terminal sequence
 19F  20185                     CALL 185[UART_TX]
 1A0  0155B                     LOAD s5, 5B["["]
 1A1  20185                     CALL 185[UART_TX]
 1A2  01532                     LOAD s5, 32["2"]
 1A3  20185                     CALL 185[UART_TX]
 1A4  0154A                     LOAD s5, 4A["J"]
 1A5  20185                     CALL 185[UART_TX]
 1A6  201B0                     CALL 1B0[delay_1ms]                          ;Delay for reliable operation
 1A7  25000                     RETURN 
 1A8                            ;
 1A8  0151B        cursor_home: LOAD s5, 1B[character_ESC]                   ;Send cursor to upper-left of display
 1A9  20185                     CALL 185[UART_TX]
 1AA  0155B                     LOAD s5, 5B["["]
 1AB  20185                     CALL 185[UART_TX]
 1AC  01548                     LOAD s5, 48["H"]
 1AD  20185                     CALL 185[UART_TX]
 1AE  201B0                     CALL 1B0[delay_1ms]                          ;Delay for reliable operation
 1AF  25000                     RETURN 
 1B0                            ;
 1B0                            ;
 1B0                            ;------------------------------------------------------------------------------------------
 1B0                            ; End of 'uart_interface_routines.psm"'
 1B0                            ;------------------------------------------------------------------------------------------
 1B0                            ;
 1B0                            INCLUDE "C:\ece540_final\picoblaze_uart\hdl_psm\delay.psm"["delay.psm"]
 1B0                            ;------------------------------------------------------------------------------------------
 1B0                            ; Auxiliary method for delay pursoses
 1B0                            ;
 1B0                            ; Originated by Ken Chapman - Xilinx Ltd
 1B0                            ; Modified by Dung Le, 2012
 1B0                            ;------------------------------------------------------------------------------------------
 1B0                            ; Software Delays
 1B0                            ;------------------------------------------------------------------------------------------
 1B0                            ;
 1B0                            ; All based on 50MHz clock
 1B0                            ; The number of iterations of a delay loop required to form each delay required are
 1B0                            ; loaded into the register set [s2,s1,s0] and then the delay loop is started.
 1B0                            ;
 1B0                            ; Registers used s0, s1, s2
 1B0                            ;
 1B0                            ;1ms is 50,000 clock cycles requiring 6,250 delay iterations
 1B0                            ;
 1B0  01200          delay_1ms: LOAD s2, 00
 1B1  01118                     LOAD s1, 18
 1B2  0106A                     LOAD s0, 6A
 1B3  221BC                     JUMP 1BC[software_delay]
 1B4                            ;
 1B4                            ;20ms is 1,000,000 clock cycles requiring 125,000 delay iterations
 1B4                            ;
 1B4  01201         delay_20ms: LOAD s2, 01
 1B5  011E8                     LOAD s1, E8
 1B6  01048                     LOAD s0, 48
 1B7  221BC                     JUMP 1BC[software_delay]
 1B8                            ;
 1B8                            ;1s is 50,000,000 clock cycles requiring 6,250,000 delay iterations
 1B8                            ;
 1B8  0125F           delay_1s: LOAD s2, 5F
 1B9  0115E                     LOAD s1, 5E
 1BA  01010                     LOAD s0, 10
 1BB  221BC                     JUMP 1BC[software_delay]
 1BC                            ;
 1BC                            ; The delay loop decrements [s2,s1,s0] until it reaches zero
 1BC                            ; Each decrement cycle is 4 instructions which is 8 clock cycles (160ns at 50MHz)
 1BC                            ;
 1BC  19001     software_delay: SUB s0, 01[1'd]
 1BD  1B100                     SUBCY s1, 00[0'd]
 1BE  1B200                     SUBCY s2, 00[0'd]
 1BF  361BC                     JUMP NZ, 1BC[software_delay]
 1C0  25000                     RETURN 
 1C1                            ;
 1C1                            ;
 1C1                            ;
 1C1                            ;
 1C1                            ;------------------------------------------------------------------------------------------
 1C1                            ; End of Program
 1C1                            ;------------------------------------------------------------------------------------------
 1C1                            ;



List of PSM files that have been assembled

C:\ece540_final\picoblaze_uart\hdl_psm\uart_control.psm
C:\ece540_final\picoblaze_uart\hdl_psm\uart_interface_routines.psm
C:\ece540_final\picoblaze_uart\hdl_psm\delay.psm



List of defined constants

 CONSTANT name        Value        Source PSM File

 timestamp_hours      13'd         
 timestamp_minutes    31'd         
 timestamp_seconds    40'd         
 datestamp_year       12'd         
 datestamp_month      11'd         
 datestamp_day        14'd         
 UART_status_port     00           uart_control.psm
 UART_Tx_data_present 00000001'b   uart_control.psm
 UART_Tx_half_full    00000010'b   uart_control.psm
 UART_Tx_full         00000100'b   uart_control.psm
 UART_Rx_data_present 00001000'b   uart_control.psm
 UART_Rx_half_full    00010000'b   uart_control.psm
 UART_Rx_full         00100000'b   uart_control.psm
 UART_TX6_output_port 01           uart_control.psm
 UART_RX6_input_port  01           uart_control.psm
 reset_UART_port      01           uart_control.psm
 UART_tx_reset        00000001'b   uart_control.psm
 UART_rx_reset        00000010'b   uart_control.psm
 UART_reset           00000011'b   uart_control.psm
 UART_operate         00000000'b   uart_control.psm
 hex_value0           00           uart_control.psm
 hex_value1           01           uart_control.psm
 decimal0             02           uart_control.psm
 decimal1             03           uart_control.psm
 decimal2             04           uart_control.psm
 decimal3             05           uart_control.psm
 decimal4             06           uart_control.psm
 character_NULL       00           uart_control.psm
 character_BS         08           uart_control.psm
 character_LF         0A           uart_control.psm
 character_CR         0D           uart_control.psm
 character_ESC        1B           uart_control.psm



No TABLEs defined



List of text strings

 STRING name       String                                                                 Source PSM File

 KCPSM6_version$   "v2.00"                                                                
 datestamp$        "14 Nov 2012"                                                          
 timestamp$        "13:31:40"                                                             
 banner1$          "  _  ______ ____  ____  __  __  __"                                   uart_control.psm
 banner2$          " | |/ / ___|  _ \/ ___||  \/  |/ /_"                                  uart_control.psm
 banner3$          " | ' / |   | |_) \___ \| |\/| | '_ \"                                 uart_control.psm
 banner4$          " | . \ |___|  __/ ___) | |  | | (_) )"                                uart_control.psm
 banner5$          " |_|\_\____|_|   |____/|_|  |_|\___/"                                 uart_control.psm
 welcome1$         "Example using the 'uart_tx6' and 'uart_rx6': type -> echo to screen"  uart_control.psm
 welcome2$         "Assembly Date: "                                                      uart_control.psm
 welcome3$         "   Time: "                                                            uart_control.psm
 welcome4$         "Assembler Version: "                                                  uart_control.psm
 welcome5$         "Hardware Design: Testing 7... -le"                                    uart_control.psm
 welcome6$         "type here: "                                                          uart_control.psm



List of line labels

 Label               Addr  Source PSM File

 cold_start          000   uart_control.psm
 main                004   uart_control.psm
 welcome_message     00A   uart_control.psm
 welcome_msg         011   uart_control.psm
 reset_UART_macros   182   uart_interface_routines.psm
 UART_TX             185   uart_interface_routines.psm
 UART_RX             18A   uart_interface_routines.psm
 rx_timeout          18B   uart_interface_routines.psm
 read_Rx             191   uart_interface_routines.psm
 send_message        193   uart_interface_routines.psm
 send_CR             19A   uart_interface_routines.psm
 send_space          19C   uart_interface_routines.psm
 clear_screen        19E   uart_interface_routines.psm
 cursor_home         1A8   uart_interface_routines.psm
 delay_1ms           1B0   delay.psm
 delay_20ms          1B4   delay.psm
 delay_1s            1B8   delay.psm
 software_delay      1BC   delay.psm



End of KCPSM6 log file.
